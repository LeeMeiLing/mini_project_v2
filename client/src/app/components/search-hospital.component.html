<div>
    <a [routerLink]="['/home']">Back to Home</a>
    <h2>Find A Hospital</h2>

    
    <form [formGroup]="countryCodeForm">
        Country:
        <select formControlName="countryCode" (ngModelChange)="onCountryCodeChange()">
            <option *ngFor="let moh of mohList" value="{{moh.countryCode}}">{{moh.countryName}}</option>
        </select>
    </form>
    
    <form [formGroup]="form" (ngSubmit)="searchSgHospitals()" *ngIf="showSgForm">

        Hospital Ownership: 
        <select formControlName="hospitalOwnership">
            <option value="">--All--</option>
            <option value="public">Public</option>
            <option value="private">Private</option>
            <option value="nonProfit">Not-for-profit</option>
        </select>
    
        <input type="text" formControlName="hospitalName" placeholder="Enter Hospital Name">

    <button mat-raised-button color="primary" type="submit">Search</button>
    <button type="button" (click)="sort()" [disabled]="disableSort">
        Sort by Rating <span *ngIf="descending">v</span>&nbsp;
        <button type="button" (click)="undoSort()"><span *ngIf="disableSort">o</span><span *ngIf="!disableSort">x</span></button>
    </button>
    </form>

    <form [formGroup]="form" (ngSubmit)="searchUsHospitals()" *ngIf="showUsForm">

            Location: 
            <select formControlName="state" (ngModelChange)="onStateChange()" >
                <option value="">--All States--</option>
                <option *ngFor="let state of states" value="{{state}}">{{state}}</option>
            </select>
            <select formControlName="city" [hidden]="!form.value['state']">
                <option value="">--All Cities--</option>
                <option *ngFor="let city of cities" value="{{city}}">{{city}}</option>
            </select>
        
            <input type="text" formControlName="hospitalName" placeholder="Enter Hospital Name">

        <button mat-raised-button color="primary" type="submit">Search</button>
        <button type="button" (click)="sort()" [disabled]="disableSort">
            Sort by Rating <span *ngIf="descending">v</span>&nbsp;
            <button type="button" (click)="undoSort()"><span *ngIf="disableSort">o</span><span *ngIf="!disableSort">x</span></button>
        </button>
    </form>
</div>
<hr>

<!-- List of US Hospitals based on Search Result -->
<div *ngIf="hospitals">
    <h3>Search Results:</h3>
    <span>total {{count}} results</span>
    <div *ngIf="hospitals.length > 0">
        <p>page {{offset + 1}} 
            <span *ngIf="offset>0"><button type="button" (click)="loadPreviousPage()">previous page</button></span>
            <span *ngIf="(offset + 1) < (count/20)"><button type="button" (click)="loadNextPage()">next page</button></span>
        </p>
        <table>
            <tr *ngFor="let h of hospitals">
                <a [routerLink]="['/hospital/us', h.facilityId]" >
                    <mat-card>
                        <mat-card-title>
                            <span>{{h.facilityName}}</span> &nbsp; &nbsp; <span>Rating: {{h.hospitalOverallRating}}/5</span>
                        </mat-card-title>
                        <mat-card-content>
                            <span>{{h.address}},{{h.city}},{{h.state}},{{h.zipCode}},{{h.countyName}}</span>
                            <br>
                            <span>{{h.phoneNumber}}</span>
                        </mat-card-content>
                    </mat-card>
                </a>
            </tr>
        </table>
    </div>
</div>


<!-- List of Sg Hospitals based on Search Result -->
<div *ngIf="hospitalSgList">
    <h3>Search Results:</h3>
    <span>total {{count}} results</span>
    <div *ngIf="hospitalSgList.length > 0">
        <p>page {{offset + 1}} 
            <span *ngIf="offset>0"><button type="button" (click)="loadPreviousPage()">previous page</button></span>
            <span *ngIf="(offset + 1) < (count/20)"><button type="button" (click)="loadNextPage()">next page</button></span>
        </p>
        <table>
            <tr *ngFor="let h of hospitalSgList">
                <a [routerLink]="['/hospital/sg', h.facilityId]" >
                    <mat-card>
                        <mat-card-title>
                            <span>{{h.facilityName}}</span> &nbsp; &nbsp; <span>Rating: {{h.hospitalOverallRating}}/5</span>
                        </mat-card-title>
                        <mat-card-content>
                            <span>{{h.address}},{{h.streetName}},{{h.zipCode}}</span>
                            <br>
                            <span>{{h.phoneNumber}}</span>
                        </mat-card-content>
                    </mat-card>
                </a>
            </tr>
        </table>
    </div>
</div>

